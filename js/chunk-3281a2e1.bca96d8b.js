(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3281a2e1"],{"0afe":function(t,e,a){},3799:function(t,e,a){"use strict";a("0afe")},a797:function(t,e,a){"use strict";a.r(e);var i=function(){var t=this,e=t._self._c;return e("div",{staticClass:"city-operation"},[e("div",{staticClass:"page-header"},[t._m(0),e("div",{staticClass:"header-right"},[e("el-input",{staticClass:"search-input",attrs:{placeholder:"搜索设施","prefix-icon":"el-icon-search",clearable:""},model:{value:t.searchQuery,callback:function(e){t.searchQuery=e},expression:"searchQuery"}}),e("el-button-group",[e("el-button",{attrs:{type:"primary",icon:"el-icon-plus"},on:{click:t.showAddFacility}},[t._v("添加设施")]),e("el-button",{attrs:{type:"success",icon:"el-icon-bell"},on:{click:t.viewAlerts}},[t._v("查看告警")]),e("el-button",{attrs:{icon:"el-icon-refresh"},on:{click:t.refreshData}},[t._v("刷新")])],1)],1)]),e("div",{staticClass:"stat-cards"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-card card-primary"},[e("div",{staticClass:"stat-icon"},[e("i",{staticClass:"el-icon-monitor"})]),e("div",{staticClass:"stat-content"},[e("div",{staticClass:"stat-label"},[t._v("监测设施数")]),e("div",{staticClass:"stat-value"},[t._v(t._s(t.facilityStats.total))]),e("div",{staticClass:"stat-trend"},[e("span",{staticClass:"trend-up"},[t._v("+2")]),t._v(" 本月")])])])]),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-card card-success"},[e("div",{staticClass:"stat-icon"},[e("i",{staticClass:"el-icon-s-operation"})]),e("div",{staticClass:"stat-content"},[e("div",{staticClass:"stat-label"},[t._v("正常运行率")]),e("div",{staticClass:"stat-value"},[t._v(t._s(t.facilityStats.normalRate)+"%")]),e("div",{staticClass:"stat-trend"},[e("span",{staticClass:"trend-up"},[t._v("+1.5%")]),t._v(" 同比")])])])]),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-card card-warning"},[e("div",{staticClass:"stat-icon"},[e("i",{staticClass:"el-icon-warning-outline"})]),e("div",{staticClass:"stat-content"},[e("div",{staticClass:"stat-label"},[t._v("当前告警数")]),e("div",{staticClass:"stat-value"},[t._v(t._s(t.facilityStats.alerts))]),e("div",{staticClass:"stat-trend"},[e("span",{staticClass:"trend-down"},[t._v("-5")]),t._v(" 本周")])])])]),e("el-col",{attrs:{span:6}},[e("div",{staticClass:"stat-card card-info"},[e("div",{staticClass:"stat-icon"},[e("i",{staticClass:"el-icon-time"})]),e("div",{staticClass:"stat-content"},[e("div",{staticClass:"stat-label"},[t._v("异常响应时效")]),e("div",{staticClass:"stat-value"},[t._v(t._s(t.facilityStats.responseTime)+"分钟")]),e("div",{staticClass:"stat-trend"},[e("span",{staticClass:"trend-down"},[t._v("-45分钟")]),t._v(" 优化")])])])])],1)],1),e("div",{staticClass:"monitoring-panel"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:16}},[e("el-card",{staticClass:"map-card"},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("城市设施地理分布")]),e("el-radio-group",{staticStyle:{float:"right"},attrs:{size:"mini"},model:{value:t.mapViewMode,callback:function(e){t.mapViewMode=e},expression:"mapViewMode"}},[e("el-radio-button",{attrs:{label:"normal"}},[t._v("常规视图")]),e("el-radio-button",{attrs:{label:"heat"}},[t._v("热力视图")])],1)],1),e("div",{ref:"facilityMap",staticClass:"facility-map"})])],1),e("el-col",{attrs:{span:8}},[e("el-card",{staticClass:"alert-card"},[e("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[e("span",[t._v("实时告警")]),e("el-button",{staticStyle:{float:"right",padding:"3px 0"},attrs:{type:"text"},on:{click:t.viewAllAlerts}},[t._v("查看全部")])],1),e("div",{staticClass:"real-time-alerts"},[0===t.recentAlerts.length?e("div",{staticClass:"no-alerts"},[e("i",{staticClass:"el-icon-success"}),e("p",[t._v("暂无告警信息")])]):e("div",{staticClass:"alert-list"},t._l(t.recentAlerts,(function(a,i){return e("div",{key:i,staticClass:"alert-item",class:{critical:"严重"===a.level,warning:"警告"===a.level,info:"一般"===a.level}},[e("div",{staticClass:"alert-time"},[t._v(t._s(a.time))]),e("div",{staticClass:"alert-content"},[e("div",{staticClass:"alert-title"},[e("el-tag",{attrs:{size:"mini",type:t.getAlertLevelType(a.level)}},[t._v(t._s(a.level))]),t._v(" "+t._s(a.facility)+" ")],1),e("div",{staticClass:"alert-desc"},[t._v(t._s(a.content))])]),e("div",{staticClass:"alert-actions"},[e("el-button",{attrs:{size:"mini",type:"primary"},on:{click:function(e){return t.handleAlert(a)}}},[t._v("处理")])],1)])})),0)])])],1)],1)],1),e("div",{staticClass:"content-section"},[e("el-tabs",{on:{"tab-click":t.handleTabChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[e("el-tab-pane",{attrs:{label:"设施监测明细",name:"facilities"}},[e("div",{staticClass:"filter-bar"},[e("el-select",{attrs:{placeholder:"设施类型",clearable:""},model:{value:t.typeFilter,callback:function(e){t.typeFilter=e},expression:"typeFilter"}},t._l(t.facilityTypes,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),e("el-select",{attrs:{placeholder:"运行状态",clearable:""},model:{value:t.statusFilter,callback:function(e){t.statusFilter=e},expression:"statusFilter"}},t._l(t.statusOptions,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1),e("el-button",{attrs:{type:"text",icon:"el-icon-refresh"},on:{click:t.resetFilters}},[t._v("重置筛选")])],1),e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.filteredFacilities,border:"",stripe:""}},[e("el-table-column",{attrs:{prop:"code",label:"编号",width:"100"}}),e("el-table-column",{attrs:{prop:"name",label:"设施名称","min-width":"150"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-link",{attrs:{type:"primary"},on:{click:function(e){return t.viewFacilityDetail(a.row)}}},[t._v(t._s(a.row.name))])]}}])}),e("el-table-column",{attrs:{prop:"type",label:"设施类型",width:"120"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:t.getTypeTagClass(a.row.type),size:"medium"}},[t._v(t._s(a.row.type))])]}}])}),e("el-table-column",{attrs:{prop:"location",label:"位置",width:"120"}}),e("el-table-column",{attrs:{prop:"load",label:"负载率",width:"180"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-progress",{attrs:{percentage:parseInt(a.row.load),status:t.getLoadStatus(a.row.load)}})]}}])}),e("el-table-column",{attrs:{prop:"lastUpdate",label:"更新时间",width:"180"}}),e("el-table-column",{attrs:{prop:"status",label:"状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:t.getStatusTagClass(a.row.status),size:"medium"}},[t._v(t._s(a.row.status))])]}}])}),e("el-table-column",{attrs:{label:"操作",width:"200",fixed:"right"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-button",{attrs:{size:"mini"},on:{click:function(e){return t.monitorFacility(a.row)}}},[t._v("监控")]),e("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(e){return t.viewTrend(a.row)}}},[t._v("趋势")]),"异常"===a.row.status?e("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(e){return t.handleFacilityAlert(a.row)}}},[t._v("处理")]):t._e()]}}])})],1),e("div",{staticClass:"pagination-container"},[e("el-pagination",{attrs:{"current-page":t.currentPage,"page-sizes":[10,20,50,100],"page-size":t.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:t.filteredFacilities.length},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange}})],1)],1),e("el-tab-pane",{attrs:{label:"数据分析",name:"analysis"}},[e("div",{staticClass:"analysis-container"},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-card",{staticClass:"chart-card",attrs:{shadow:"hover"}},[e("div",{staticClass:"chart-header",attrs:{slot:"header"},slot:"header"},[e("span",[e("i",{staticClass:"el-icon-pie-chart"}),t._v(" 设施类型分布")])]),e("div",{ref:"typeChart",staticClass:"chart-container"})])],1),e("el-col",{attrs:{span:12}},[e("el-card",{staticClass:"chart-card",attrs:{shadow:"hover"}},[e("div",{staticClass:"chart-header",attrs:{slot:"header"},slot:"header"},[e("span",[e("i",{staticClass:"el-icon-warning"}),t._v(" 告警趋势分析")])]),e("div",{ref:"alertTrendChart",staticClass:"chart-container"})])],1)],1),e("el-row",{staticStyle:{"margin-top":"20px"},attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("el-card",{staticClass:"chart-card",attrs:{shadow:"hover"}},[e("div",{staticClass:"chart-header",attrs:{slot:"header"},slot:"header"},[e("span",[e("i",{staticClass:"el-icon-data-line"}),t._v(" 平均负载率")])]),e("div",{ref:"loadChart",staticClass:"chart-container"})])],1),e("el-col",{attrs:{span:12}},[e("el-card",{staticClass:"chart-card",attrs:{shadow:"hover"}},[e("div",{staticClass:"chart-header",attrs:{slot:"header"},slot:"header"},[e("span",[e("i",{staticClass:"el-icon-time"}),t._v(" 响应时间分析")])]),e("div",{ref:"responseTimeChart",staticClass:"chart-container"})])],1)],1)],1)])],1)],1),e("el-dialog",{attrs:{visible:t.detailVisible,width:"70%",title:t.currentFacility.name+" - 设施详情",center:""},on:{"update:visible":function(e){t.detailVisible=e}}},[e("el-descriptions",{attrs:{column:2,border:""}},[e("el-descriptions-item",{attrs:{label:"设施名称"}},[t._v(t._s(t.currentFacility.name))]),e("el-descriptions-item",{attrs:{label:"设施编号"}},[t._v(t._s(t.currentFacility.code))]),e("el-descriptions-item",{attrs:{label:"设施类型"}},[t._v(t._s(t.currentFacility.type))]),e("el-descriptions-item",{attrs:{label:"运行状态"}},[t._v(t._s(t.currentFacility.status))]),e("el-descriptions-item",{attrs:{label:"位置"}},[t._v(t._s(t.currentFacility.location))]),e("el-descriptions-item",{attrs:{label:"负载率"}},[t._v(t._s(t.currentFacility.load)+"%")]),e("el-descriptions-item",{attrs:{label:"最近更新"}},[t._v(t._s(t.currentFacility.lastUpdate))]),e("el-descriptions-item",{attrs:{label:"负责部门"}},[t._v(t._s(t.currentFacility.department))]),e("el-descriptions-item",{attrs:{label:"设施描述",span:2}},[t._v(t._s(t.currentFacility.description))])],1),e("el-tabs",{staticStyle:{"margin-top":"20px"}},[e("el-tab-pane",{attrs:{label:"实时数据"}},[e("el-row",{attrs:{gutter:20}},[e("el-col",{attrs:{span:12}},[e("div",{ref:"realTimeChart",staticStyle:{height:"300px"}})]),e("el-col",{attrs:{span:12}},[e("el-card",{staticClass:"parameter-card"},[e("div",{attrs:{slot:"header"},slot:"header"},[t._v("运行参数")]),e("div",{staticClass:"parameter-list"},[e("div",{staticClass:"parameter-item"},[e("span",{staticClass:"parameter-label"},[t._v("运行时长:")]),e("span",{staticClass:"parameter-value"},[t._v(t._s(t.currentFacility.runtime||"720小时"))])]),e("div",{staticClass:"parameter-item"},[e("span",{staticClass:"parameter-label"},[t._v("当前负载:")]),e("span",{staticClass:"parameter-value"},[t._v(t._s(t.currentFacility.load||"65")+"%")])]),e("div",{staticClass:"parameter-item"},[e("span",{staticClass:"parameter-label"},[t._v("能耗:")]),e("span",{staticClass:"parameter-value"},[t._v(t._s(t.currentFacility.power||"120")+"kWh")])]),e("div",{staticClass:"parameter-item"},[e("span",{staticClass:"parameter-label"},[t._v("温度:")]),e("span",{staticClass:"parameter-value"},[t._v(t._s(t.currentFacility.temperature||"35")+"°C")])]),e("div",{staticClass:"parameter-item"},[e("span",{staticClass:"parameter-label"},[t._v("湿度:")]),e("span",{staticClass:"parameter-value"},[t._v(t._s(t.currentFacility.humidity||"45")+"%")])])])])],1)],1)],1),e("el-tab-pane",{attrs:{label:"历史告警"}},[e("el-table",{attrs:{data:t.facilityAlerts,border:""}},[e("el-table-column",{attrs:{prop:"time",label:"告警时间",width:"180"}}),e("el-table-column",{attrs:{prop:"level",label:"告警级别",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:t.getAlertLevelType(a.row.level)}},[t._v(t._s(a.row.level))])]}}])}),e("el-table-column",{attrs:{prop:"content",label:"告警内容"}}),e("el-table-column",{attrs:{prop:"duration",label:"持续时间",width:"100"}}),e("el-table-column",{attrs:{prop:"status",label:"处理状态",width:"100"},scopedSlots:t._u([{key:"default",fn:function(a){return[e("el-tag",{attrs:{type:"已处理"===a.row.status?"success":"warning"}},[t._v(t._s(a.row.status))])]}}])}),e("el-table-column",{attrs:{prop:"handler",label:"处理人",width:"100"}})],1)],1)],1)],1),e("el-dialog",{attrs:{visible:t.monitorVisible,width:"80%",title:"实时监控",center:""},on:{"update:visible":function(e){t.monitorVisible=e}}},[t.currentFacility?e("div",{staticClass:"monitor-container"},[e("div",{staticClass:"monitor-header"},[e("h3",[t._v(t._s(t.currentFacility.name)+" "),e("el-tag",{attrs:{type:t.getStatusTagClass(t.currentFacility.status)}},[t._v(t._s(t.currentFacility.status))])],1),e("div",{staticClass:"update-info"},[t._v("上次更新: "+t._s((new Date).toLocaleTimeString()))])]),e("el-row",{staticClass:"monitor-content",attrs:{gutter:20}},[e("el-col",{attrs:{span:16}},[e("div",{ref:"monitorChart",staticClass:"monitor-chart"})]),e("el-col",{attrs:{span:8}},[e("div",{staticClass:"parameter-panel"},[e("div",{staticClass:"parameter-group"},[e("div",{staticClass:"group-title"},[t._v("基本参数")]),e("div",{staticClass:"group-content"},[e("el-row",{attrs:{gutter:10}},[e("el-col",{attrs:{span:12}},[e("div",{staticClass:"parameter-card"},[e("div",{staticClass:"parameter-name"},[t._v("负载率")]),e("div",{staticClass:"parameter-value"},[t._v(t._s(t.currentFacility.load)+"%")]),e("el-progress",{attrs:{percentage:parseInt(t.currentFacility.load),status:t.getLoadStatus(t.currentFacility.load)}})],1)]),e("el-col",{attrs:{span:12}},[e("div",{staticClass:"parameter-card"},[e("div",{staticClass:"parameter-name"},[t._v("温度")]),e("div",{staticClass:"parameter-value"},[t._v(t._s(t.currentFacility.temperature||"35")+"°C")]),e("el-progress",{attrs:{percentage:parseInt(t.currentFacility.temperature||"35"),status:t.getTemperatureStatus(t.currentFacility.temperature||"35")}})],1)])],1),e("el-row",{staticStyle:{"margin-top":"10px"},attrs:{gutter:10}},[e("el-col",{attrs:{span:12}},[e("div",{staticClass:"parameter-card"},[e("div",{staticClass:"parameter-name"},[t._v("能耗")]),e("div",{staticClass:"parameter-value"},[t._v(t._s(t.currentFacility.power||"120")+"kWh")]),e("el-progress",{attrs:{percentage:parseInt(t.currentFacility.power||"120")/2,status:"success"}})],1)]),e("el-col",{attrs:{span:12}},[e("div",{staticClass:"parameter-card"},[e("div",{staticClass:"parameter-name"},[t._v("湿度")]),e("div",{staticClass:"parameter-value"},[t._v(t._s(t.currentFacility.humidity||"45")+"%")]),e("el-progress",{attrs:{percentage:parseInt(t.currentFacility.humidity||"45"),status:"success"}})],1)])],1)],1)]),e("div",{staticClass:"action-panel"},[e("el-button",{attrs:{type:"primary",icon:"el-icon-video-camera"},on:{click:t.toggleVideo}},[t._v("视频监控")]),e("el-button",{attrs:{type:"warning",icon:"el-icon-bell"},on:{click:t.testAlarm}},[t._v("测试告警")]),e("el-button",{attrs:{type:"success",icon:"el-icon-download"},on:{click:t.exportData}},[t._v("导出数据")])],1)])])],1)],1):t._e()]),e("el-dialog",{attrs:{visible:t.addVisible,width:"600px",title:"添加监测设施",center:""},on:{"update:visible":function(e){t.addVisible=e}}},[e("el-form",{attrs:{model:t.facilityForm,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"设施名称"}},[e("el-input",{attrs:{placeholder:"请输入设施名称"},model:{value:t.facilityForm.name,callback:function(e){t.$set(t.facilityForm,"name",e)},expression:"facilityForm.name"}})],1),e("el-form-item",{attrs:{label:"设施类型"}},[e("el-select",{attrs:{placeholder:"请选择设施类型"},model:{value:t.facilityForm.type,callback:function(e){t.$set(t.facilityForm,"type",e)},expression:"facilityForm.type"}},t._l(t.facilityTypes,(function(t){return e("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})})),1)],1),e("el-form-item",{attrs:{label:"位置"}},[e("el-input",{attrs:{placeholder:"请输入设施位置"},model:{value:t.facilityForm.location,callback:function(e){t.$set(t.facilityForm,"location",e)},expression:"facilityForm.location"}})],1),e("el-form-item",{attrs:{label:"负责部门"}},[e("el-input",{attrs:{placeholder:"请输入负责部门"},model:{value:t.facilityForm.department,callback:function(e){t.$set(t.facilityForm,"department",e)},expression:"facilityForm.department"}})],1),e("el-form-item",{attrs:{label:"设施描述"}},[e("el-input",{attrs:{type:"textarea",rows:"4",placeholder:"请输入设施描述"},model:{value:t.facilityForm.description,callback:function(e){t.$set(t.facilityForm,"description",e)},expression:"facilityForm.description"}})],1)],1),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.addVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveFacility}},[t._v("保存")])],1)],1),e("el-dialog",{attrs:{visible:t.alertVisible,width:"600px",title:"告警处理",center:""},on:{"update:visible":function(e){t.alertVisible=e}}},[t.currentAlert?e("div",{staticClass:"alert-detail"},[e("el-alert",{attrs:{title:t.currentAlert.level+"告警",type:t.getAlertLevelType(t.currentAlert.level),description:t.currentAlert.content,"show-icon":"",closable:!1}}),e("div",{staticClass:"alert-info"},[e("p",[e("strong",[t._v("设施名称:")]),t._v(" "+t._s(t.currentAlert.facility))]),e("p",[e("strong",[t._v("告警时间:")]),t._v(" "+t._s(t.currentAlert.time))]),e("p",[e("strong",[t._v("设施位置:")]),t._v(" "+t._s(t.currentAlert.location))])]),e("el-form",{staticClass:"alert-form",attrs:{model:t.alertForm,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"处理方式"}},[e("el-select",{attrs:{placeholder:"请选择处理方式"},model:{value:t.alertForm.method,callback:function(e){t.$set(t.alertForm,"method",e)},expression:"alertForm.method"}},[e("el-option",{attrs:{label:"远程处理",value:"远程处理"}}),e("el-option",{attrs:{label:"现场处理",value:"现场处理"}}),e("el-option",{attrs:{label:"转交专家",value:"转交专家"}})],1)],1),e("el-form-item",{attrs:{label:"处理人"}},[e("el-input",{attrs:{placeholder:"请输入处理人姓名"},model:{value:t.alertForm.handler,callback:function(e){t.$set(t.alertForm,"handler",e)},expression:"alertForm.handler"}})],1),e("el-form-item",{attrs:{label:"处理记录"}},[e("el-input",{attrs:{type:"textarea",rows:"3",placeholder:"请输入处理记录"},model:{value:t.alertForm.remark,callback:function(e){t.$set(t.alertForm,"remark",e)},expression:"alertForm.remark"}})],1)],1)],1):t._e(),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(e){t.alertVisible=!1}}},[t._v("取消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.saveAlertHandler}},[t._v("确认处理")])],1)])],1)},s=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"header-left"},[e("h2",{staticClass:"page-title"},[t._v("城市运营监测")]),e("div",{staticClass:"page-desc"},[t._v("实时监测城市基础设施、公共服务等运行状况，为城市管理提供决策支持。")])])}],r=a("313e"),l=a("2f62"),n={name:"CityOperation",data(){return{searchQuery:"",typeFilter:"",statusFilter:"",activeTab:"facilities",currentPage:1,pageSize:10,mapViewMode:"normal",facilityStats:{total:15,normalRate:92,alerts:3,responseTime:15},facilityTypes:[{value:"交通设施",label:"交通设施"},{value:"水务设施",label:"水务设施"},{value:"电力设施",label:"电力设施"},{value:"环保设施",label:"环保设施"},{value:"通信设施",label:"通信设施"},{value:"照明设施",label:"照明设施"},{value:"公共安全",label:"公共安全"}],statusOptions:[{value:"正常",label:"正常"},{value:"异常",label:"异常"},{value:"维护中",label:"维护中"},{value:"待检修",label:"待检修"}],detailVisible:!1,monitorVisible:!1,addVisible:!1,alertVisible:!1,currentFacility:{},currentAlert:null,facilityForm:{name:"",type:"",location:"",department:"",description:""},alertForm:{method:"远程处理",handler:"",remark:""},facilities:[{code:"CF001",name:"中心区交通信号灯系统",type:"交通设施",location:"市中心十字路口",status:"正常",load:"65",lastUpdate:"2025-05-30 10:15:26",department:"交通管理局",description:"中心区智能交通信号灯系统，负责交通路口信号灯控制",runtime:"720小时",power:"120",temperature:"35",humidity:"45"},{code:"CF002",name:"第一水厂供水系统",type:"水务设施",location:"城北新区",status:"正常",load:"72",lastUpdate:"2025-05-30 10:12:18",department:"水务局",description:"城市第一水厂供水系统，负责城北区域供水",runtime:"1200小时",power:"350",temperature:"28",humidity:"65"},{code:"CF003",name:"东区变电站",type:"电力设施",location:"城东工业园",status:"异常",load:"87",lastUpdate:"2025-05-30 10:05:42",department:"电力局",description:"东区主要变电站，负责工业园区供电",runtime:"960小时",power:"580",temperature:"42",humidity:"38"},{code:"CF004",name:"环保监测站",type:"环保设施",location:"生态公园",status:"正常",load:"58",lastUpdate:"2025-05-30 10:08:33",department:"环保局",description:"城市环境质量监测站，实时监测空气质量",runtime:"840小时",power:"90",temperature:"26",humidity:"52"},{code:"CF005",name:"5G通信基站",type:"通信设施",location:"城市中心",status:"待检修",load:"78",lastUpdate:"2025-05-30 09:55:12",department:"通信管理局",description:"5G移动通信基站，提供高速移动通信服务",runtime:"680小时",power:"210",temperature:"36",humidity:"40"},{code:"CF006",name:"主干道智能路灯系统",type:"照明设施",location:"城市主干道",status:"维护中",load:"42",lastUpdate:"2025-05-30 09:48:05",department:"城管局",description:"主干道智能路灯控制系统，支持自动调光",runtime:"520小时",power:"150",temperature:"30",humidity:"48"},{code:"CF007",name:"中心广场监控系统",type:"公共安全",location:"城市中心广场",status:"正常",load:"62",lastUpdate:"2025-05-30 10:02:37",department:"公安局",description:"中心广场视频监控系统，保障公共安全",runtime:"890小时",power:"130",temperature:"32",humidity:"44"},{code:"CF008",name:"南区水质监测站",type:"水务设施",location:"南湖公园",status:"异常",load:"83",lastUpdate:"2025-05-30 09:38:51",department:"水务局",description:"南区水质在线监测系统，实时监控水质参数",runtime:"720小时",power:"110",temperature:"38",humidity:"75"}],recentAlerts:[{id:"AL001",time:"2025-05-30 10:05:42",facility:"东区变电站",location:"城东工业园",level:"严重",content:"负载率超过安全阈值，当前87%",status:"待处理"},{id:"AL002",time:"2025-05-30 09:38:51",facility:"南区水质监测站",location:"南湖公园",level:"警告",content:"水质浊度参数异常，超出标准范围",status:"待处理"},{id:"AL003",time:"2025-05-30 09:15:30",facility:"西区交通信号灯",location:"西区商业中心",level:"一般",content:"信号灯控制延迟，响应时间异常",status:"处理中"}],facilityAlerts:[{time:"2025-05-28 14:20:15",level:"严重",content:"负载率超过安全阈值，当前91%",duration:"30分钟",status:"已处理",handler:"张工"},{time:"2025-05-25 08:45:32",level:"警告",content:"温度过高，达到45°C",duration:"45分钟",status:"已处理",handler:"李工"},{time:"2025-05-20 16:12:08",level:"一般",content:"通信信号波动",duration:"15分钟",status:"已处理",handler:"王工"},{time:"2025-05-15 10:30:22",level:"警告",content:"电压不稳定",duration:"60分钟",status:"已处理",handler:"刘工"}],charts:{typeChart:null,alertTrendChart:null,loadChart:null,responseTimeChart:null}}},computed:{...Object(l["b"])(["cityData"]),filteredFacilities(){return this.searchQuery||this.typeFilter||this.statusFilter?this.facilities.filter(t=>{const e=!this.searchQuery||t.name.toLowerCase().includes(this.searchQuery.toLowerCase())||t.location&&t.location.toLowerCase().includes(this.searchQuery.toLowerCase()),a=!this.typeFilter||t.type===this.typeFilter,i=!this.statusFilter||t.status===this.statusFilter;return e&&a&&i}):this.facilities}},mounted(){this.initCharts(),this.initMap(),this.refreshTimer=setInterval(()=>{this.updateRealTimeData()},3e4),window.addEventListener("resize",this.resizeCharts)},beforeDestroy(){this.refreshTimer&&clearInterval(this.refreshTimer),window.removeEventListener("resize",this.resizeCharts),Object.values(this.charts).forEach(t=>{t&&t.dispose()})},methods:{initCharts(){setTimeout(()=>{this.initTypeChart(),this.initAlertTrendChart(),this.initLoadChart(),this.initResponseTimeChart(),console.log("所有图表初始化完成")},300)},resizeCharts(){Object.values(this.charts).forEach(t=>{t&&t.resize()})},initTypeChart(){this.$refs.typeChart?(console.log("初始化typeChart",this.$refs.typeChart.offsetHeight),this.charts.typeChart&&this.charts.typeChart.dispose(),this.$nextTick(()=>{this.charts.typeChart=r["init"](this.$refs.typeChart),this.charts.typeChart.setOption({title:{text:"设施类型分布",left:"center",top:0,textStyle:{fontSize:16,color:"#333"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b}: {c} ({d}%)"},legend:{orient:"vertical",left:10,top:"center",data:this.facilityTypes.map(t=>t.label)},series:[{name:"设施类型",type:"pie",radius:["50%","70%"],center:["60%","50%"],avoidLabelOverlap:!1,label:{show:!1,position:"center"},emphasis:{label:{show:!0,fontSize:"18",fontWeight:"bold"}},labelLine:{show:!1},data:[{value:3,name:"交通设施",itemStyle:{color:"#409EFF"}},{value:2,name:"水务设施",itemStyle:{color:"#67C23A"}},{value:1,name:"电力设施",itemStyle:{color:"#E6A23C"}},{value:1,name:"环保设施",itemStyle:{color:"#19be6b"}},{value:1,name:"通信设施",itemStyle:{color:"#F56C6C"}},{value:2,name:"照明设施",itemStyle:{color:"#909399"}},{value:1,name:"公共安全",itemStyle:{color:"#9254de"}}]}]}),this.charts.typeChart.resize()})):console.warn("typeChart ref不存在")},initAlertTrendChart(){this.$refs.alertTrendChart?(console.log("初始化alertTrendChart",this.$refs.alertTrendChart.offsetHeight),this.charts.alertTrendChart&&this.charts.alertTrendChart.dispose(),this.$nextTick(()=>{this.charts.alertTrendChart=r["init"](this.$refs.alertTrendChart),this.charts.alertTrendChart.setOption({title:{text:"告警趋势分析",left:"center",textStyle:{fontSize:16,color:"#333"}},tooltip:{trigger:"axis"},legend:{data:["严重告警","警告告警","一般告警"],bottom:0},grid:{left:"3%",right:"4%",bottom:"10%",top:"15%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:["周一","周二","周三","周四","周五","周六","周日"],axisLine:{lineStyle:{color:"#ddd"}}},yAxis:{type:"value",axisLine:{lineStyle:{color:"#ddd"}},splitLine:{lineStyle:{color:"#eee"}}},series:[{name:"严重告警",type:"line",stack:"Total",data:[2,1,3,2,1,0,1],itemStyle:{color:"#F56C6C"},areaStyle:{color:new r["graphic"].LinearGradient(0,0,0,1,[{offset:0,color:"rgba(245, 108, 108, 0.5)"},{offset:1,color:"rgba(245, 108, 108, 0.1)"}])},smooth:!0},{name:"警告告警",type:"line",stack:"Total",data:[3,4,5,3,2,3,2],itemStyle:{color:"#E6A23C"},areaStyle:{color:new r["graphic"].LinearGradient(0,0,0,1,[{offset:0,color:"rgba(230, 162, 60, 0.5)"},{offset:1,color:"rgba(230, 162, 60, 0.1)"}])},smooth:!0},{name:"一般告警",type:"line",stack:"Total",data:[5,6,4,5,7,4,3],itemStyle:{color:"#909399"},areaStyle:{color:new r["graphic"].LinearGradient(0,0,0,1,[{offset:0,color:"rgba(144, 147, 153, 0.5)"},{offset:1,color:"rgba(144, 147, 153, 0.1)"}])},smooth:!0}]}),this.charts.alertTrendChart.resize()})):console.warn("alertTrendChart ref不存在")},initLoadChart(){this.$refs.loadChart?(console.log("初始化loadChart",this.$refs.loadChart.offsetHeight),this.charts.loadChart&&this.charts.loadChart.dispose(),this.$nextTick(()=>{this.charts.loadChart=r["init"](this.$refs.loadChart),this.charts.loadChart.setOption({title:{text:"设施平均负载率",left:"center",textStyle:{fontSize:16,color:"#333"}},tooltip:{trigger:"axis",formatter:"{b}<br />{a}: {c}%"},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"category",data:["00:00","03:00","06:00","09:00","12:00","15:00","18:00","21:00"],axisLine:{lineStyle:{color:"#ddd"}},axisLabel:{color:"#666"}},yAxis:{type:"value",axisLabel:{formatter:"{value}%",color:"#666"},axisLine:{lineStyle:{color:"#ddd"}},splitLine:{lineStyle:{color:"#eee"}}},series:[{name:"负载率",data:[45,42,48,62,75,68,72,58],type:"line",smooth:!0,lineStyle:{width:4,color:"#409EFF"},itemStyle:{color:"#409EFF"},areaStyle:{color:new r["graphic"].LinearGradient(0,0,0,1,[{offset:0,color:"rgba(64, 158, 255, 0.5)"},{offset:1,color:"rgba(64, 158, 255, 0.1)"}])},markLine:{data:[{name:"警戒线",yAxis:80,lineStyle:{color:"#F56C6C",type:"dashed",width:2},label:{formatter:"警戒线(80%)",position:"insideEndTop",color:"#F56C6C",fontSize:12}}]}}]}),this.charts.loadChart.resize()})):console.warn("loadChart ref不存在")},initResponseTimeChart(){this.$refs.responseTimeChart?(console.log("初始化responseTimeChart",this.$refs.responseTimeChart.offsetHeight),this.charts.responseTimeChart&&this.charts.responseTimeChart.dispose(),this.$nextTick(()=>{this.charts.responseTimeChart=r["init"](this.$refs.responseTimeChart),this.charts.responseTimeChart.setOption({title:{text:"告警响应时间趋势",left:"center",textStyle:{fontSize:16,color:"#333"}},tooltip:{trigger:"axis",formatter:"{b}<br />{a}: {c}分钟"},grid:{left:"3%",right:"4%",bottom:"3%",top:"15%",containLabel:!0},xAxis:{type:"category",data:["1月","2月","3月","4月","5月","6月"],axisLine:{lineStyle:{color:"#ddd"}},axisLabel:{color:"#666"}},yAxis:{type:"value",axisLabel:{formatter:"{value}分钟",color:"#666"},axisLine:{lineStyle:{color:"#ddd"}},splitLine:{lineStyle:{color:"#eee"}}},series:[{data:[60,50,40,30,20,15],type:"line",name:"平均响应时间",smooth:!0,lineStyle:{width:4,color:"#67C23A"},itemStyle:{color:"#67C23A"},areaStyle:{color:new r["graphic"].LinearGradient(0,0,0,1,[{offset:0,color:"rgba(103, 194, 58, 0.5)"},{offset:1,color:"rgba(103, 194, 58, 0.1)"}])},markLine:{data:[{name:"目标线",yAxis:15,lineStyle:{color:"#409EFF",type:"dashed",width:2},label:{formatter:"目标线(15分钟)",position:"insideEndTop",color:"#409EFF",fontSize:12}}]}}]}),this.charts.responseTimeChart.resize()})):console.warn("responseTimeChart ref不存在")},initMap(){this.$nextTick(()=>{if(this.$refs.facilityMap){const t=r["init"](this.$refs.facilityMap);t.setOption({title:{text:"城市设施分布",left:"center"},tooltip:{trigger:"item",formatter:function(t){return t.name+"<br/>负载率: "+t.value[2]+"%<br/>状态: "+t.data.status}},xAxis:{type:"value",name:"经度",min:120.1,max:120.3,splitLine:{show:!0}},yAxis:{type:"value",name:"纬度",min:30.2,max:30.4,splitLine:{show:!0}},series:[{type:"scatter",symbolSize:function(t){return t[2]/10+5},data:[{name:"交通信号灯系统",value:[120.13,30.28,65],status:"正常"},{name:"第一水厂供水系统",value:[120.18,30.35,72],status:"正常"},{name:"东区变电站",value:[120.22,30.3,87],status:"异常"},{name:"环保监测站",value:[120.15,30.25,58],status:"正常"},{name:"5G通信基站",value:[120.16,30.29,78],status:"待检修"},{name:"智能路灯系统",value:[120.2,30.32,42],status:"维护中"},{name:"中心广场监控系统",value:[120.17,30.31,62],status:"正常"},{name:"南区水质监测站",value:[120.14,30.26,83],status:"异常"}],itemStyle:{color:function(t){return"异常"===t.data.status?"#F56C6C":"待检修"===t.data.status?"#E6A23C":"维护中"===t.data.status?"#909399":"#67C23A"}},label:{show:!0,formatter:"{b}",position:"right"}}]}),t.on("click",t=>{if("series"===t.componentType){const e=this.facilities.find(e=>e.name===t.name);e&&this.viewFacilityDetail(e)}})}})},initRealTimeChart(){this.$nextTick(()=>{if(this.$refs.realTimeChart){const t=r["init"](this.$refs.realTimeChart);t.setOption({title:{text:"实时运行数据"},tooltip:{trigger:"axis"},legend:{data:["负载率","温度","能耗"]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:{type:"category",boundaryGap:!1,data:["09:00","09:10","09:20","09:30","09:40","09:50","10:00","10:10"]},yAxis:{type:"value"},series:[{name:"负载率",type:"line",data:[65,68,72,75,70,68,65,67],itemStyle:{color:"#409EFF"}},{name:"温度",type:"line",data:[35,36,37,38,38,37,36,35],itemStyle:{color:"#F56C6C"}},{name:"能耗",type:"line",data:[120,122,125,130,128,125,122,120],itemStyle:{color:"#67C23A"}}]})}})},initMonitorChart(){this.$nextTick(()=>{if(this.$refs.monitorChart){const t=r["init"](this.$refs.monitorChart),e=new Date,a=[],i=[];for(let s=0;s<24;s++){const t=new Date(e-5*(23-s)*60*1e3);a.unshift(t.getHours()+":"+(t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes()));const r=parseInt(this.currentFacility.load||65),l=Math.floor(10*Math.random())-5;i.unshift(Math.max(0,Math.min(100,r+l)))}t.setOption({title:{text:"实时负载监控"},tooltip:{trigger:"axis",formatter:function(t){return t[0].name+"<br>"+t[0].seriesName+": "+t[0].value+"%<br>更新时间: "+(new Date).toLocaleTimeString()}},xAxis:{type:"category",boundaryGap:!1,data:a},yAxis:{type:"value",min:0,max:100,axisLabel:{formatter:"{value}%"}},series:[{name:"负载率",type:"line",smooth:!0,data:i,markLine:{data:[{name:"警戒线",yAxis:80,lineStyle:{color:"#F56C6C"},label:{formatter:"警戒线(80%)",position:"insideEndTop"}}]},areaStyle:{opacity:.3,color:new r["graphic"].LinearGradient(0,0,0,1,[{offset:0,color:"rgba(58,77,233,0.8)"},{offset:1,color:"rgba(58,77,233,0.3)"}])}}]})}})},updateRealTimeData(){this.facilities.forEach(t=>{const e=Math.floor(5*Math.random())-2;t.load=Math.max(0,Math.min(100,parseInt(t.load)+e)).toString();const a=Math.floor(3*Math.random())-1;t.temperature=Math.max(20,Math.min(50,parseInt(t.temperature||"35")+a)).toString(),t.lastUpdate=(new Date).toLocaleString()}),this.monitorVisible&&this.currentFacility&&this.$refs.monitorChart&&this.initMonitorChart(),this.checkForAlerts()},checkForAlerts(){const t=new Date;this.facilities.forEach(e=>{if(parseInt(e.load)>80&&"异常"!==e.status){const a={id:"AL"+Math.floor(1e4*Math.random()),time:t.toLocaleString(),facility:e.name,location:e.location,level:parseInt(e.load)>90?"严重":"警告",content:`负载率超过安全阈值，当前${e.load}%`,status:"待处理"};e.status="异常",e.lastUpdate=t.toLocaleString(),this.recentAlerts.unshift(a),this.recentAlerts.length>10&&this.recentAlerts.pop(),this.$notify({title:"设施告警",message:`${e.name}：${a.content}`,type:"warning",duration:0})}if(parseInt(e.temperature||"35")>40&&"异常"!==e.status){const a={id:"AL"+Math.floor(1e4*Math.random()),time:t.toLocaleString(),facility:e.name,location:e.location,level:parseInt(e.temperature)>45?"严重":"警告",content:`设备温度过高，当前${e.temperature}°C`,status:"待处理"};e.status="异常",e.lastUpdate=t.toLocaleString(),this.recentAlerts.unshift(a),this.recentAlerts.length>10&&this.recentAlerts.pop(),this.$notify({title:"设施告警",message:`${e.name}：${a.content}`,type:"warning",duration:0})}})},showAddFacility(){this.facilityForm={name:"",type:"",location:"",department:"",description:""},this.addVisible=!0},saveFacility(){if(!this.facilityForm.name||!this.facilityForm.type)return void this.$message.warning("请填写完整的设施信息");const t={code:"CF"+(this.facilities.length+10).toString().padStart(3,"0"),name:this.facilityForm.name,type:this.facilityForm.type,location:this.facilityForm.location,status:"正常",load:"50",lastUpdate:(new Date).toLocaleString(),department:this.facilityForm.department,description:this.facilityForm.description,runtime:"0小时",power:"0",temperature:"25",humidity:"50"};this.facilities.unshift(t),this.facilityStats.total=this.facilities.length,this.$message.success("设施添加成功"),this.addVisible=!1,this.initCharts(),this.initMap()},viewAlerts(){this.recentAlerts.length>0?(this.currentAlert=this.recentAlerts[0],this.alertVisible=!0):this.$message.info("当前没有告警信息")},refreshData(){this.updateRealTimeData(),this.$message.success("数据已刷新")},resetFilters(){this.searchQuery="",this.typeFilter="",this.statusFilter=""},handleSizeChange(t){this.pageSize=t},handleCurrentChange(t){this.currentPage=t},getTypeTagClass(t){const e={"交通设施":"primary","水务设施":"info","电力设施":"warning","环保设施":"success","通信设施":"danger","照明设施":"","公共安全":"info"};return e[t]||"info"},getStatusTagClass(t){const e={"正常":"success","异常":"danger","维护中":"info","待检修":"warning"};return e[t]||"info"},getAlertLevelType(t){const e={"严重":"danger","警告":"warning","一般":"info"};return e[t]||"info"},getLoadStatus(t){const e=parseInt(t);return e>=80?"exception":e>=60?"warning":"success"},getTemperatureStatus(t){const e=parseInt(t);return e>=40?"exception":e>=35?"warning":"success"},viewFacilityDetail(t){this.currentFacility=t,this.detailVisible=!0,this.$nextTick(()=>{this.initRealTimeChart()})},monitorFacility(t){this.currentFacility=t,this.monitorVisible=!0,this.$nextTick(()=>{this.initMonitorChart()})},viewTrend(t){this.currentFacility=t,this.activeTab="analysis",this.$nextTick(()=>{this.initCharts()}),this.$message.info(`正在查看${t.name}的运行趋势`)},handleFacilityAlert(t){const e=this.recentAlerts.find(e=>e.facility===t.name&&"待处理"===e.status);e?(this.currentAlert=e,this.alertVisible=!0):this.$message.info("没有找到相关告警信息")},handleAlert(t){this.currentAlert=t,this.alertForm={method:"远程处理",handler:"",remark:""},this.alertVisible=!0},saveAlertHandler(){if(!this.alertForm.handler)return void this.$message.warning("请填写处理人信息");const t=this.recentAlerts.findIndex(t=>t.id===this.currentAlert.id);-1!==t&&(this.recentAlerts[t].status="处理中",this.facilityAlerts.unshift({time:this.currentAlert.time,level:this.currentAlert.level,content:this.currentAlert.content,duration:"进行中",status:"处理中",handler:this.alertForm.handler}));const e=this.facilities.findIndex(t=>t.name===this.currentAlert.facility);-1!==e&&(this.facilities[e].status="维护中",this.facilities[e].lastUpdate=(new Date).toLocaleString()),this.facilityStats.alerts=this.recentAlerts.filter(t=>"待处理"===t.status).length,this.$message.success("告警处理任务已创建"),this.alertVisible=!1,this.$notify({title:"告警响应",message:`${this.currentAlert.facility}的告警已分配给${this.alertForm.handler}处理，预计响应时间15分钟内`,type:"success",duration:4500})},toggleVideo(){this.$message.info("正在连接视频监控...")},testAlarm(){this.$confirm("确定要测试告警功能吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$message.success("告警测试成功，系统响应正常")}).catch(()=>{})},exportData(){this.$message.success("数据导出成功")},viewAllAlerts(){this.$router.push("/monitor")},handleTabChange(t){"analysis"===t&&this.$nextTick(()=>{this.initCharts()})}},watch:{activeTab(t){"analysis"===t&&this.$nextTick(()=>{this.initCharts()})}}},o=n,c=(a("3799"),a("2877")),d=Object(c["a"])(o,i,s,!1,null,"413c392e",null);e["default"]=d.exports}}]);
//# sourceMappingURL=chunk-3281a2e1.bca96d8b.js.map